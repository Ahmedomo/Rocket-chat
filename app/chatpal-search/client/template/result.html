<template name="ChatpalSearchResultTemplate">
	<div class="chatpal-search-container">
		<ul class="chatpal-search-typefilter">
			<li value="All" class="{{navSelected 'All'}}">{{_ "Chatpal_All_Results"}}</li>
			<li value="Messages" class="{{navSelected 'Messages'}}">{{_ "Chatpal_Messages"}}</li>
			{{#if fileSearchSupported}}<li value="Files" class="{{navSelected 'Files'}}">{{_ "Chatpal_Files"}}</li>{{/if}}
		</ul>
		<div class="chatpal-search-result">
			{{#if searching}}
				<div class="chatpal_search-loader">
					{{> loading}}
				</div>
			{{else}}
				{{#unless result}}
					<p class="chatpal-search-welcome">
						{{_ "Chatpal_Welcome"}}
					</p>
				{{/unless}}
				{{#if $eq resultType "All"}}
					{{#if result.user.docs}}
						<div class="chatpal-search-result-header">
							{{_ "Chatpal_Users"}}
						</div>
						<div class="chatpal-search-result-list">
							{{#each result.user.docs}}
								{{> ChatpalSearchSingleUser}}
							{{/each}}
						</div>
					{{/if}}
					{{#if result.room.docs}}
						<div class="chatpal-search-result-header">
							{{_ "Chatpal_Rooms"}}
						</div>
						<div class="chatpal-search-result-list">
							{{#each result.room.docs}}
								{{> ChatpalSearchSingleRoom}}
							{{/each}}
						</div>
					{{/if}}
					{{#if fileSearchSupported}}
						{{#if result.file.docs}}
							<div class="chatpal-search-result-header">
								{{_ "Chatpal_Files"}}
							</div>
							<div class="chatpal-search-result-list">
								{{#each result.file.docs}}
									{{> ChatpalSearchSingleFile}}
								{{/each}}
							</div>
							{{#if moreThanDisplayed 'file'}}
								<div class="chatpal-show-more more-files">{{_ "Chatpal_More"}}</div>
							{{/if}}
						{{/if}}
					{{/if}}
					{{#if result.message.docs}}
						<div class="chatpal-search-result-header">
							{{_ "Chatpal_Messages"}}
						</div>
						<div class="chatpal-search-result-list">
							{{#each result.message.docs}}
								{{> ChatpalSearchSingleMessage}}
							{{/each}}
						</div>
						{{#if moreThanDisplayed 'message'}}
							<div class="chatpal-show-more more-messages">{{_ "Chatpal_More"}}</div>
						{{/if}}
					{{/if}}

					{{#if $not resultsFoundForAllSearch}}
						<div class="chatpal-search-result-header">
							<h2 class="chatpal-search-number">
								<h2>{{_ "Chatpal_No_Results"}}</h2>
							</h2>
						</div>
					{{/if}}
				{{/if}}
				{{#if $eq resultType "Messages"}}
					<div class="chatpal-search-result-header">
						<h2 class="chatpal-search-number">
							{{resultNumFound}}
						</h2>
					</div>
					{{#if result.message}}
						<div class="chatpal-search-result-list">
							{{#each result.message.docs}}
								{{> ChatpalSearchSingleMessage}}
							{{/each}}
						</div>
					{{/if}}
					{{#if resultPaging}}
						{{#if $neq resultPaging.numOfPages 0}}
							<div class="chatpal-paging">
								{{#if $gt resultPaging.currentPage 1}}
									<div class="chatpal-paging-prev chatpal-paging-button">
										<i class="icon-left-circled2"></i>
									</div>
								{{/if}}
								<div class="chatpal-paging-text">{{_ "Chatpal_search_page_of"
																	 resultPaging.currentPage
																	 resultPaging.numOfPages}}</div>
								{{#if $lt resultPaging.currentPage resultPaging.numOfPages}}
									<div class="chatpal-paging-next chatpal-paging-button">
										<i class="icon-right-circled2"></i>
									</div>
								{{/if}}
							</div>
						{{/if}}
					{{/if}}
				{{/if}}
				{{#if fileSearchSupported}}
					{{#if $eq resultType "Files"}}
						<div class="chatpal-search-result-header">
							<h2 class="chatpal-search-number">
								{{resultNumFound}}
							</h2>
						</div>
						{{#if result.file}}
							<div class="chatpal-search-result-list">
								{{#each result.file.docs}}
									{{> ChatpalSearchSingleFile}}
								{{/each}}
							</div>
						{{/if}}
						{{#if resultPaging}}
							{{#if $neq resultPaging.numOfPages 0}}
								<div class="chatpal-paging">
									{{#if $gt resultPaging.currentPage 1}}
										<div class="chatpal-paging-prev chatpal-paging-button">
											<i class="icon-left-circled2"></i>
										</div>
									{{/if}}
									<div class="chatpal-paging-text">{{_ "Chatpal_search_page_of"
										resultPaging.currentPage
										resultPaging.numOfPages}}</div>
									{{#if $lt resultPaging.currentPage resultPaging.numOfPages}}
										<div class="chatpal-paging-next chatpal-paging-button">
											<i class="icon-right-circled2"></i>
										</div>
									{{/if}}
								</div>
							{{/if}}
						{{/if}}
					{{/if}}
				{{/if}}
			{{/if}}
		</div>
	</div>
</template>

<template name="ChatpalSearchSingleMessage">
	<div class="chatpal-search-result-single">
		<h2>
			<span class="chatpal-channel">
				{{> icon icon=roomIcon}}
				{{roomName}}</span>
			<a class="chatpal-link" href="{{roomLink}}?msg={{_id}}">{{_ "Chatpal_go_to_message"}}</a>
			<span class="chatpal-date">{{date}}</span>
		</h2>
		<div class="chatpal-result-row">
			<div class="chatpal-avatar">
				<div class="chatpal-avatar-image"
					 style="background-image:url({{getAvatarUrl cleanUsername }});"></div>
			</div>
			<div class="chatpal-result-content">
				<span class="chatpal-name">{{username}}</span>
				<span class="chatpal-time">{{time}}</span>
				<div class="chatpal-message">{{{text}}}</div>
			</div>
		</div>
	</div>
</template>

<template name="ChatpalSearchSingleFile">
	<div class="chatpal-search-result-single">
		<h2>
			<span class="chatpal-channel">
				{{> icon icon=roomIcon}}
				{{roomName}}</span>
			<a class="chatpal-link" href="{{roomLink}}?msg={{mid}}">{{_ "Chatpal_go_to_message"}}</a>
			<span class="chatpal-date">{{date}}</span>
		</h2>
		<div class="chatpal-result-row">
			<div class="chatpal-avatar">
				<div class="chatpal-avatar-image"
					 style="background-image:url({{ getAvatarUrl username }});"></div>
			</div>
			<div class="chatpal-result-content">
				<span class="chatpal-name">{{username}}</span>
				<span class="chatpal-time">{{time}}</span><br/>
				<a class="chatpal-file-link attachment-download-icon rc-tooltip" aria-label="{{_ 'Download'}}" href="{{file_link}}" target="_blank" rel="noopener noreferrer" download="">
					<span class="chatpal-file-name">{{{file_name}}}</span> {{> icon icon="download"}}
				</a><br/>
				<div class="chatpal-file-desc">{{{file_desc}}}</div>
				{{#unless textMatchingFilename}}
					<div class="chatpal-file-content">{{{text}}}</div>
				{{/unless}}
				<span class="chatpal-size">{{fileSize}}</span>
			</div>
		</div>
	</div>
</template>

<template name="ChatpalSearchSingleUser">
	<div class="chatpal-search-result-user">
		<div class="chatpal-avatar">
			<div class="chatpal-avatar-image" style="background-image:url({{ getAvatarUrl cleanUsername }});"></div>
		</div>
		<h2>{{{user_name}}}{{#unless nameMatchingUsername}} (@{{{user_username}}}){{/unless}}</h2>
		<div class="direct-message">
			<a href="{{ getDMUrl cleanUsername }}">{{_ "Chatpal_go_to_user"}}</a>
		</div>
	</div>
</template>

<template name="ChatpalSearchSingleRoom">
	<div class="chatpal-search-result-room">
		<h2>
			<span class="chatpal-channel">
				{{> icon icon=roomIcon}}
				{{{room_name}}}</span>
			<a class="chatpal-link" href="{{roomLink}}">{{_ "Chatpal_go_to_room"}}</a>
		</h2>
		<div class="chatpal-search-pills">
			{{#if room_topic}}
				<div class="chatpal-search-pills-topic">{{{room_topic}}}</div>
			{{/if}}
			{{#if room_description}}
				<div class="chatpal-search-pills-description">{{{room_description}}}</div>
			{{/if}}
			{{#if room_announcement}}
				<div class="chatpal-search-pills-announcement">{{{room_announcement}}}</div>
			{{/if}}
		</div>
	</div>
</template>
