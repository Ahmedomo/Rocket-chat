{"metadata":{},"options":{"assumptions":{},"compact":false,"sourceMaps":true,"ast":true,"babelrc":false,"configFile":false,"parserOpts":{"sourceType":"module","sourceFileName":"/home/weslley/Documents/projects/Rocket.Chat/server/lib/roles/removeUserFromRoles.ts","plugins":["*","flow","jsx","asyncGenerators","bigInt","classPrivateMethods","classPrivateProperties","classProperties","doExpressions","dynamicImport","exportDefaultFrom","exportExtensions","exportNamespaceFrom","functionBind","functionSent","importMeta","nullishCoalescingOperator","numericSeparator","objectRestSpread","optionalCatchBinding","optionalChaining",["pipelineOperator",{"proposal":"minimal"}],"throwExpressions","objectRestSpread","asyncGenerators","classProperties","classPrivateProperties","jsx","nullishCoalescingOperator","nullishCoalescingOperator","optionalChaining","optionalCatchBinding","optionalCatchBinding","classProperties","classPrivateProperties","classPrivateMethods","classProperties","classPrivateProperties","asyncGenerators","asyncGenerators","objectRestSpread","logicalAssignment"],"allowImportExportEverywhere":true,"allowReturnOutsideFunction":true,"allowUndeclaredExports":true,"strictMode":false},"caller":{"name":"meteor","arch":"os.linux.x86_64"},"sourceFileName":"server/lib/roles/removeUserFromRoles.ts","filename":"/home/weslley/Documents/projects/Rocket.Chat/server/lib/roles/removeUserFromRoles.ts","inputSourceMap":{"version":3,"file":"server/lib/roles/removeUserFromRoles.ts","sourceRoot":"","sources":["server/lib/roles/removeUserFromRoles.ts"],"names":[],"mappings":"AAEA,OAAO,EAAE,KAAK,EAAE,KAAK,EAAE,MAAM,gCAAgC,CAAC;AAC9D,OAAO,EAAE,gBAAgB,EAAE,MAAM,oBAAoB,CAAC;AACtD,OAAO,EAAE,WAAW,EAAE,MAAM,kBAAkB,CAAC;AAE/C,MAAM,CAAC,MAAM,wBAAwB,GAAG,KAAK,EAAE,MAAoB,EAAE,OAAuB,EAAE,KAAoB,EAAoB,EAAE;IACvI,IAAI,CAAC,MAAM,IAAI,CAAC,OAAO,EAAE;QACxB,OAAO,KAAK,CAAC;KACb;IAED,MAAM,IAAI,GAAG,MAAM,KAAK,CAAC,WAAW,CAAC,MAAM,EAAE,EAAE,UAAU,EAAE,EAAE,GAAG,EAAE,CAAC,EAAE,EAAE,CAAC,CAAC;IACzE,IAAI,CAAC,IAAI,EAAE;QACV,MAAM,IAAI,WAAW,CAAC,oBAAoB,EAAE,cAAc,CAAC,CAAC;KAC5D;IAED,IAAI,CAAC,CAAC,MAAM,gBAAgB,CAAC,OAAO,CAAC,CAAC,EAAE;QACvC,MAAM,IAAI,WAAW,CAAC,oBAAoB,EAAE,cAAc,CAAC,CAAC;KAC5D;IAED,MAAM,KAAK,CAAC,eAAe,CAAC,MAAM,EAAE,OAAO,EAAE,KAAK,CAAC,CAAC;IACpD,OAAO,IAAI,CAAC;AACb,CAAC,CAAC;AAEF,MAAM,CAAC,MAAM,mBAAmB,GAAG,CAAC,GAAG,IAAiD,EAAW,EAAE,CACpG,OAAO,CAAC,KAAK,CAAC,wBAAwB,CAAC,GAAG,IAAI,CAAC,CAAC,CAAC","sourcesContent":["import type { IRole, IUser } from '../../../definition/IUser';\nimport type { IRoom } from '../../../definition/IRoom';\nimport { Users, Roles } from '../../../app/models/server/raw';\nimport { validateRoleList } from './validateRoleList';\nimport { MeteorError } from '../../sdk/errors';\n\nexport const removeUserFromRolesAsync = async (userId: IUser['_id'], roleIds: IRole['_id'][], scope?: IRoom['_id']): Promise<boolean> => {\n\tif (!userId || !roleIds) {\n\t\treturn false;\n\t}\n\n\tconst user = await Users.findOneById(userId, { projection: { _id: 1 } });\n\tif (!user) {\n\t\tthrow new MeteorError('error-invalid-user', 'Invalid user');\n\t}\n\n\tif (!(await validateRoleList(roleIds))) {\n\t\tthrow new MeteorError('error-invalid-role', 'Invalid role');\n\t}\n\n\tawait Roles.removeUserRoles(userId, roleIds, scope);\n\treturn true;\n};\n\nexport const removeUserFromRoles = (...args: Parameters<typeof removeUserFromRolesAsync>): boolean =>\n\tPromise.await(removeUserFromRolesAsync(...args));\n"]},"targets":{"android":"95.0.0","chrome":"95.0.0","edge":"95.0.0","firefox":"78.0.0","ie":"10.0.0","ios":"15.0.0","opera":"81.0.0","safari":"15.1.0","samsung":"14.0.0"},"cloneInputAst":true,"browserslistConfigFile":false,"passPerPreset":false,"envName":"development","cwd":"/home/weslley/Documents/projects/Rocket.Chat","root":"/home/weslley/Documents/projects/Rocket.Chat","rootMode":"root","plugins":[{"key":"base$0","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0","visitor":{"Program":{"enter":[null],"exit":[null]},"_exploded":true,"_verified":true},"options":{"avoidModernSyntax":false,"enforceStrictMode":false,"dynamicImport":true,"generateLetDeclarations":true}},{"key":"transform-runtime","visitor":{"MemberExpression":{"enter":[null]},"ObjectPattern":{"enter":[null]},"BinaryExpression":{"enter":[null]},"_exploded":{},"_verified":{},"Identifier":{"enter":[null]},"JSXIdentifier":{"enter":[null]}},"options":{"version":"7.16.5","helpers":true,"useESModules":false,"corejs":false}},{"key":"syntax-object-rest-spread","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-object-rest-spread","visitor":{"VariableDeclarator":{"enter":[null]},"ExportNamedDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"AssignmentExpression":{"enter":[null]},"ArrayPattern":{"enter":[null]},"ObjectExpression":{"enter":[null]},"_exploded":true,"_verified":true,"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]}},"options":{}},{"key":"transform-meteor-async-await","visitor":{"AwaitExpression":{"enter":[null]},"_exploded":true,"_verified":true,"FunctionDeclaration":{"exit":[null]},"FunctionExpression":{"exit":[null]},"ObjectMethod":{"exit":[null]},"ArrowFunctionExpression":{"exit":[null]},"ClassMethod":{"exit":[null]},"ClassPrivateMethod":{"exit":[null]}},"options":{"useNativeAsyncAwait":false}},{"key":"proposal-async-generator-functions","visitor":{"_exploded":{},"_verified":{},"Program":{"enter":[null]}},"options":{}},{"key":"proposal-class-properties","visitor":{"PrivateName":{"enter":[null]},"ExportDefaultDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]}},"options":{"loose":true}},{"key":"transform-react-jsx","visitor":{"_exploded":{},"_verified":{},"JSXNamespacedName":{"enter":[null]},"JSXSpreadChild":{"enter":[null]},"Program":{"enter":[null]},"JSXElement":{"exit":[null]},"JSXFragment":{"exit":[null]},"JSXAttribute":{"enter":[null]}},"options":{"pragma":"React.createElement","pragmaFrag":"React.Fragment","runtime":"classic","throwIfNamespace":true,"useBuiltIns":false}},{"key":"transform-react-display-name","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-react-pure-annotations","visitor":{"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"syntax-nullish-coalescing-operator","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-nullish-coalescing-operator","visitor":{"_exploded":{},"_verified":{},"LogicalExpression":{"enter":[null]}},"options":{}},{"key":"syntax-optional-chaining","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-optional-chaining","visitor":{"_exploded":true,"OptionalCallExpression":{"enter":[null]},"OptionalMemberExpression":{"enter":[null]},"_verified":true},"options":{}},{"key":"syntax-optional-catch-binding","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-optional-catch-binding","visitor":{"_exploded":{},"_verified":{},"CatchClause":{"enter":[null]}},"options":{}},{"key":"syntax-class-properties","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-class-properties","visitor":{"PrivateName":{"enter":[null]},"ExportDefaultDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]}},"options":{}},{"key":"syntax-async-generators","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-async-generator-functions","visitor":{"_exploded":{},"_verified":{},"Program":{"enter":[null]}},"options":{}},{"key":"syntax-object-rest-spread","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-object-rest-spread","visitor":{"VariableDeclarator":{"enter":[null]},"ExportNamedDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"AssignmentExpression":{"enter":[null]},"ArrayPattern":{"enter":[null]},"ObjectExpression":{"enter":[null]},"_exploded":true,"_verified":true,"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]}},"options":{}},{"key":"proposal-logical-assignment-operators","visitor":{"_exploded":{},"_verified":{},"AssignmentExpression":{"enter":[null]}},"options":{}},{"key":"transform-literals","visitor":{"NumericLiteral":{"enter":[null]},"StringLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-template-literals","visitor":{"TaggedTemplateExpression":{"enter":[null]},"TemplateLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-parameters","visitor":{"_exploded":true,"_verified":true,"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]}},"options":{}},{"key":"transform-exponentiation-operator","visitor":{"AssignmentExpression":{"enter":[null]},"BinaryExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}}],"presets":[],"generatorOpts":{"filename":"/home/weslley/Documents/projects/Rocket.Chat/server/lib/roles/removeUserFromRoles.ts","comments":true,"compact":false,"sourceMaps":true,"sourceFileName":"server/lib/roles/removeUserFromRoles.ts"}},"code":"module.export({\n  removeUserFromRolesAsync: () => removeUserFromRolesAsync,\n  removeUserFromRoles: () => removeUserFromRoles\n});\nlet Users, Roles;\nmodule.link(\"../../../app/models/server/raw\", {\n  Users(v) {\n    Users = v;\n  },\n\n  Roles(v) {\n    Roles = v;\n  }\n\n}, 0);\nlet validateRoleList;\nmodule.link(\"./validateRoleList\", {\n  validateRoleList(v) {\n    validateRoleList = v;\n  }\n\n}, 1);\nlet MeteorError;\nmodule.link(\"../../sdk/errors\", {\n  MeteorError(v) {\n    MeteorError = v;\n  }\n\n}, 2);\n\nconst removeUserFromRolesAsync = (userId, roleIds, scope) => Promise.asyncApply(() => {\n  if (!userId || !roleIds) {\n    return false;\n  }\n\n  const user = Promise.await(Users.findOneById(userId, {\n    projection: {\n      _id: 1\n    }\n  }));\n\n  if (!user) {\n    throw new MeteorError('error-invalid-user', 'Invalid user');\n  }\n\n  if (!Promise.await(validateRoleList(roleIds))) {\n    throw new MeteorError('error-invalid-role', 'Invalid role');\n  }\n\n  Promise.await(Roles.removeUserRoles(userId, roleIds, scope));\n  return true;\n});\n\nconst removeUserFromRoles = function () {\n  return Promise.await(removeUserFromRolesAsync(...arguments));\n};","map":{"version":3,"sources":["server/lib/roles/removeUserFromRoles.ts"],"names":[],"mappings":"AAEA,MAAA,CAAO,MAAP,CAAc;AAAA,EAAA,wBAAe,EAAA,MAAA,wBAAf;AAAgD,EAAA,mBAAA,EAAA,MAAA;AAAhD,CAAd;AAA8D,IAAA,KAAA,EAAA,KAAA;AAAA,MAAA,CAAA,IAAA,CAAA,gCAAA,EAAA;AAAA,EAAA,KAAA,CAAA,CAAA,EAAA;AAAA,IAAA,KAAA,GAAA,CAAA;AAAA,GAAA;;AAAA,EAAA,KAAA,CAAA,CAAA,EAAA;AAAA,IAAA,KAAA,GAAA,CAAA;AAAA;;AAAA,CAAA,EAAA,CAAA;AAAA,IAAA,gBAAA;AAAA,MAAA,CAAA,IAAA,CAAA,oBAAA,EAAA;AAAA,EAAA,gBAAA,CAAA,CAAA,EAAA;AAAA,IAAA,gBAAA,GAAA,CAAA;AAAA;;AAAA,CAAA,EAAA,CAAA;AAAA,IAAA,WAAA;AAAA,MAAA,CAAA,IAAA,CAAA,kBAAA,EAAA;AAAA,EAAA,WAAA,CAAA,CAAA,EAAA;AAAA,IAAA,WAAA,GAAA,CAAA;AAAA;;AAAA,CAAA,EAAA,CAAA;;AAIvD,MAAM,wBAAwB,GAAG,CAAO,MAAP,EAA6B,OAA7B,EAAsD,KAAtD,8BAAgG;AACvI,MAAI,CAAC,MAAD,IAAW,CAAC,OAAhB,EAAyB;AACxB,WAAO,KAAP;AACA;;AAED,QAAM,IAAI,iBAAS,KAAK,CAAC,WAAN,CAAkB,MAAlB,EAA0B;AAAE,IAAA,UAAU,EAAE;AAAE,MAAA,GAAG,EAAE;AAAP;AAAd,GAA1B,CAAT,CAAV;;AACA,MAAI,CAAC,IAAL,EAAW;AACV,UAAM,IAAI,WAAJ,CAAgB,oBAAhB,EAAsC,cAAtC,CAAN;AACA;;AAED,MAAI,eAAQ,gBAAgB,CAAC,OAAD,CAAxB,CAAJ,EAAwC;AACvC,UAAM,IAAI,WAAJ,CAAgB,oBAAhB,EAAsC,cAAtC,CAAN;AACA;;AAED,gBAAM,KAAK,CAAC,eAAN,CAAsB,MAAtB,EAA8B,OAA9B,EAAuC,KAAvC,CAAN;AACA,SAAO,IAAP;AACA,CAhBuC,CAAjC;;AAkBA,MAAM,mBAAmB,GAAG;AAAA,SAClC,OAAO,CAAC,KAAR,CAAc,wBAAwB,CAAC,YAAD,CAAtC,CADkC;AAAA,CAA5B","sourcesContent":["import type { IRole, IUser } from '../../../definition/IUser';\nimport type { IRoom } from '../../../definition/IRoom';\nimport { Users, Roles } from '../../../app/models/server/raw';\nimport { validateRoleList } from './validateRoleList';\nimport { MeteorError } from '../../sdk/errors';\n\nexport const removeUserFromRolesAsync = async (userId: IUser['_id'], roleIds: IRole['_id'][], scope?: IRoom['_id']): Promise<boolean> => {\n\tif (!userId || !roleIds) {\n\t\treturn false;\n\t}\n\n\tconst user = await Users.findOneById(userId, { projection: { _id: 1 } });\n\tif (!user) {\n\t\tthrow new MeteorError('error-invalid-user', 'Invalid user');\n\t}\n\n\tif (!(await validateRoleList(roleIds))) {\n\t\tthrow new MeteorError('error-invalid-role', 'Invalid role');\n\t}\n\n\tawait Roles.removeUserRoles(userId, roleIds, scope);\n\treturn true;\n};\n\nexport const removeUserFromRoles = (...args: Parameters<typeof removeUserFromRolesAsync>): boolean =>\n\tPromise.await(removeUserFromRolesAsync(...args));\n"],"sourceRoot":""},"sourceType":"module","hash":"f9cc429e2f670115c37dd1bb41d9fc1524ca185d"}
